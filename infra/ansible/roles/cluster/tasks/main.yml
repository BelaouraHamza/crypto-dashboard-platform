---
- name: Start Minikube cluster (docker driver)
  community.general.minikube:
    state: started
    driver: docker
    cpus: 2
    memory: 4096
    disk_size: 20000
  become: yes


- name: Enable ingress addon
  command: minikube addons enable ingress

- name: Create ArgoCD namespace
  community.kubernetes.k8s:
    state: present
    definition:
      apiVersion: v1
      kind: Namespace
      metadata:
        name: argocd

- name: Install ArgoCD
  community.kubernetes.k8s:
    state: present
    namespace: argocd
    src: https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
